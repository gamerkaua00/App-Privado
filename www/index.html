<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GhostMsg Ultimate</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>

    <div id="toast-container"></div>
    
    <input type="file" id="file-input-img" accept="image/*" hidden onchange="processarArquivo(this, 'image')">
    <input type="file" id="file-input-video" accept="video/*" hidden onchange="processarArquivo(this, 'video')">
    <input type="file" id="bg-input" accept="image/*" hidden onchange="mudarWallpaper(this)">
    <input type="file" id="avatar-input" accept="image/*" hidden onchange="mudarAvatar(this)">

    <div id="view-home" class="view active">
        <div class="header glass">
            <div class="header-left">
                <div class="mini-avatar" onclick="abrirConfig()" id="home-avatar">?</div>
                <span class="app-title">GhostMsg</span>
            </div>
            <div class="actions">
                <i class="material-icons" onclick="abrirQR()">qr_code</i>
                <i class="material-icons" onclick="abrirConfig()">settings</i>
            </div>
        </div>
        
        <div id="contact-list"></div>

        <button class="fab ripple" onclick="mostrarModalAdd()">
            <i class="material-icons">add</i>
        </button>
    </div>

    <div id="view-chat" class="view">
        <div id="chat-wallpaper"></div>

        <div class="header chat-header glass">
            <button class="icon-btn" onclick="voltarHome()"><i class="material-icons">arrow_back</i></button>
            <div class="chat-info">
                <div class="chat-name" id="current-chat-name">Nome</div>
                <div class="chat-status">
                    <span id="status-dot"></span> <span id="current-chat-status">...</span>
                </div>
            </div>
            <i class="material-icons" onclick="limparChatAtual()" style="font-size: 1.2rem; opacity: 0.7;">delete</i>
        </div>

        <div id="messages-area"></div>

        <div class="input-container glass-panel">
            <button class="icon-btn" id="btn-attach" onclick="toggleAnexos()">
                <i class="material-icons">attach_file</i>
            </button>
            
            <input type="text" id="msg-input" placeholder="Mensagem..." autocomplete="off">
            
            <button class="send-btn-round" id="btn-action" onclick="acaoPrincipal()">
                <i class="material-icons" id="icon-action">mic</i>
            </button>
        </div>

        <div id="attach-menu" class="glass-panel">
            <div class="attach-item" onclick="document.getElementById('file-input-img').click()">
                <i class="material-icons" style="color:#d32f2f">image</i> Foto
            </div>
            <div class="attach-item" onclick="document.getElementById('file-input-video').click()">
                <i class="material-icons" style="color:#1976d2">videocam</i> Vídeo
            </div>
        </div>

        <div id="audio-recorder" class="glass-panel">
            <span id="record-timer">00:00</span>
            <span class="record-status">Gravando...</span>
            <button class="icon-btn" onclick="cancelarGravacao()" style="color:red"><i class="material-icons">delete</i></button>
            <button class="icon-btn" onclick="enviarAudio()" style="color:#00ff88"><i class="material-icons">send</i></button>
        </div>
    </div>

    <div id="view-settings" class="view">
        <div class="header glass">
            <button class="icon-btn" onclick="voltarHome()"><i class="material-icons">arrow_back</i></button>
            <span>Configurações</span>
        </div>
        <div class="settings-content">
            
            <div class="profile-section">
                <div class="big-avatar" id="settings-avatar" onclick="document.getElementById('avatar-input').click()">
                    <i class="material-icons">camera_alt</i>
                </div>
                <input type="text" id="my-nickname" placeholder="Seu Nome" onblur="salvarPerfil()">
                <small>Toque na foto para alterar</small>
            </div>

            <div class="card glass-card">
                <h3>Aparência</h3>
                <div class="setting-row" onclick="document.getElementById('bg-input').click()">
                    <span><i class="material-icons">wallpaper</i> Papel de Parede Chat</span>
                    <i class="material-icons">chevron_right</i>
                </div>
                <div class="setting-row">
                    <span><i class="material-icons">palette</i> Tema Escuro</span>
                    <input type="checkbox" id="toggle-theme" checked onchange="toggleTema(this)">
                </div>
            </div>

            <div class="card glass-card">
                <h3>Dados e Armazenamento</h3>
                <div class="setting-row">
                    <span>Download Automático</span>
                    <input type="checkbox" id="toggle-auto-dl" onchange="toggleAutoDownload(this)">
                </div>
            </div>

            <div class="id-box" onclick="copiarID()">
                <small>SEU ID (Toque para copiar)</small>
                <div id="my-id-display">...</div>
            </div>
        </div>
    </div>

    <div id="modal-qr" class="modal">
        <div class="modal-card glass-card" style="text-align:center">
            <h3>Seu QR Code</h3>
            <div id="qrcode-container"></div>
            <p>Peça para seu amigo escanear</p>
            <button onclick="fecharModalQR()" class="fill-btn">Fechar</button>
        </div>
    </div>

    <div id="modal-add" class="modal">
        <div class="modal-card glass-card">
            <h3>Novo Contato</h3>
            <input type="text" id="new-contact-name" placeholder="Nome">
            <input type="text" id="new-contact-id" placeholder="Cole o ID">
            <div class="modal-actions">
                <button onclick="fecharModalAdd()" class="text-btn">Cancelar</button>
                <button onclick="salvarNovoContato()" class="fill-btn">Salvar</button>
            </div>
            <button onclick="adicionarEuMesmo()" class="self-chat-btn">Conversar Comigo Mesmo</button>
        </div>
    </div>

    <script src="js/script.js"></script>
</body>
</html>
